webpackJsonp([1],{"2mV7":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("gNcp"),n={};r.keys().forEach(function(t){"./index.js"!==t&&(n[t.replace(/(\.\/|\.js)/g,"")]=r(t).default)}),e.default=n},"7RzV":function(t,e){},"7zck":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",{attrs:{fluid:""}},[e("v-slide-y-transition",{attrs:{mode:"out-in"}},[e("v-layout",{attrs:{row:"",wrap:""}},[e("v-flex",{attrs:{xs10:"","offset-xs1":""}},[e("v-alert",{attrs:{value:this.show,type:this.type}},[this._v(this._s(this.message))])],1)],1)],1)],1)},staticRenderFns:[]};var s={components:{Alert:a("VU/8")({data:function(){return{}},computed:{show:function(){return this.$store.state.Alert.show},message:function(){return this.$store.state.Alert.message},type:function(){return this.$store.state.Alert.type}},name:"Alert"},n,!1,function(t){a("xVVC")},"data-v-43d0351c",null).exports},data:function(){return{drawer:!1,items:[{icon:"book",title:"Project",to:"/project"}],miniVariant:!1,title:"雲端物聯網分析平台"}},mounted:function(){var t=this;console.log(this.$store.state.User.jwt_token),this.$store.state.User.jwt_token&&(this.$http.setToken(this.$store.state.User.jwt_token),this.$http.getme().then(function(e){var a=e.data;t.$store.commit("SET_USER",a)}))},computed:{user:function(){return this.$store.state.User}},name:"App"},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{persistent:"","mini-variant":t.miniVariant,"enable-resize-watcher":"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",t._l(t.items,function(e,r){return a("v-list-tile",{key:r,attrs:{router:"",to:e.to}},[a("v-list-tile-action",[a("v-icon",{domProps:{innerHTML:t._s(e.icon)}})],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",{domProps:{textContent:t._s(e.title)}})],1)],1)}))],1),t._v(" "),a("v-toolbar",{attrs:{app:""}},[a("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),t._v(" "),a("v-toolbar-title",{domProps:{textContent:t._s(t.title)}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[t.user.alreadyLogin?a("v-btn",{attrs:{flat:""}},[t._v(t._s(t.user.username))]):a("v-btn",{attrs:{flat:"",to:"login"}},[t._v("Login")])],1)],1),t._v(" "),a("v-content",[a("Alert"),t._v(" "),a("router-view")],1)],1)},staticRenderFns:[]},i=a("VU/8")(s,o,!1,null,null,null).exports,l=a("/ocq"),c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-slide-y-transition",{attrs:{mode:"out-in"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:"","offset-xs1":""}},[a("v-text-field",{attrs:{label:"Username",placeholder:"Username"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),t._v(" "),a("v-text-field",{attrs:{label:"Password",placeholder:"Password",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),a("v-btn",{attrs:{color:"success"},on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")({data:function(){return{username:"",password:""}},methods:{login:function(t){var e=this;this.$http.login(this.username,this.password).then(function(t){var a=t.data.token;return e.$store.commit("SET_JWT_TOKEN",a),e.$http.setToken(a),e.$http.getme()}).catch(function(t){e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})}).then(function(t){var a=t.data;e.$store.commit("SET_USER",a),e.$router.push("/")})}},mounted:function(){this.$store.state.User.alreadyLogin&&this.$router.push("/")},name:"Login"},c,!1,function(t){a("pNoV")},"data-v-4b5d47f3",null).exports,u={data:function(){return{dialog:!1,newProjectName:"",newProjectDetail:"",headers:[{text:"專案名稱",sortable:!0,value:"name"},{text:"創立者",sortable:!0,value:"creater"},{text:"建立時間",sortable:!0,value:"created_at"}],projects:[]}},methods:{getProjects:function(t){var e=this;this.$http.getProjects().then(function(t){var a=t.data;e.projects=a}).catch(function(t){e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},createProject:function(){var t=this;this.dialog=!0,this.$http.createProject(this.newProjectName,this.newProjectDetail).then(function(e){e.data;t.getProjects(),t.dialog=!1})},enterProjectDetail:function(t){this.$router.push({name:"projectDetail",params:{id:t}})}},mounted:function(){this.$store.state.User.jwt_token&&(this.$http.setToken(this.$store.state.User.jwt_token),this.getProjects())},filters:{ISO8601toLocalTime:function(t){return new Date(t).toLocaleString()}},name:"Project"},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-slide-y-transition",{attrs:{mode:"out-in"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs2:"",md2:"","offset-xs10":"","offset-md10":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{attrs:{slot:"activator",color:"primary",block:"",dark:""},slot:"activator"},[a("v-card-text",[t._v("新增專案")])],1),t._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("新增專案")])]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"物聯網專案名稱",autofocus:"true",required:""},model:{value:t.newProjectName,callback:function(e){t.newProjectName=e},expression:"newProjectName"}}),t._v(" "),a("v-textarea",{attrs:{label:"專案描述",required:""},model:{value:t.newProjectDetail,callback:function(e){t.newProjectDetail=e},expression:"newProjectDetail"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("關閉")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){return t.createProject(e)}}},[t._v("儲存")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs10:"","offset-xs1":""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.projects,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",[a("td",[a("a",{on:{click:function(a){if(a.target!==a.currentTarget)return null;t.enterProjectDetail(e.item.id)}}},[t._v(t._s(e.item.name))])]),t._v(" "),a("td",[t._v(t._s(e.item.creater))]),t._v(" "),a("td",[t._v(t._s(t._f("ISO8601toLocalTime")(e.item.created_at)))])])]}}])})],1)],1)],1)],1)},staticRenderFns:[]};var f=a("VU/8")(u,v,!1,function(t){a("7RzV")},"data-v-738c8a84",null).exports,p=a("BO1k"),h=a.n(p),m=a("d7EF"),_=a.n(m),g={data:function(){return{projectId:null,project:{},devices:[],sensors:[],dialog:!1,newDeviceName:"",headers:[{text:"Name",sortable:!0,value:"name"}]}},methods:{getProjectDetail:function(t){var e=this;this.$http.getProjectDetail(t).then(function(t){var a=t.data;e.project=a}).catch(function(t){console.log(t),e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},getDeviceList:function(t){var e=this;this.$http.getDevices(t).then(function(t){var a=t.data;e.devices=a}).catch(function(t){console.log(t),e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},getSensorList:function(t){var e=this;this.$http.getSensorsByProject(t).then(function(t){var a=t.data;e.sensors=a;var r=function(t,a){e.$set(e.sensors[t],"updateArgs",[!0,!0,{duration:1e3}]),e.$set(e.sensors[t],"chartOptions",{chart:{type:"spline"},title:{text:a.showname},xAxis:{type:"datetime",title:{text:"Time (UTC)"}},plotOptions:{spline:{marker:{enabled:!0}}},series:[{data:[],color:"#6fcd98",name:a.showname}]});var r=setInterval(function(){return e.getSensorData(a.id)},5e3);e.$set(e.sensors[t],"intervalId",r)},n=!0,s=!1,o=void 0;try{for(var i,l=h()(e.sensors.entries());!(n=(i=l.next()).done);n=!0){var c=i.value,d=_()(c,2);r(d[0],d[1])}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}}).catch(function(t){e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},createDevice:function(){var t=this;this.$http.createDevice(this.newDeviceName,this.projectId).then(function(e){e.data;t.getDeviceList(t.projectId),t.dialog=!1}).catch(function(e){t.$store.dispatch("SET_ALERT",{type:"error",message:e.response.data.message||e.response.data.detail})})},enterDeviceDetail:function(t){this.$router.push({name:"deviceDetail",params:{id:t}})},getSensorData:function(t){var e=null,a=!0,r=!1,n=void 0;try{for(var s,o=h()(this.sensors);!(a=(s=o.next()).done);a=!0){var i=s.value;if(i.id===t){e=i;break}}}catch(t){r=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}this.$http.getDataBySensorId(t).then(function(t){var a=[],r=[],n=!0,s=!1,o=void 0;try{for(var i,l=h()(t);!(n=(i=l.next()).done);n=!0){var c=i.value,d=new Date(1e3*c.timestamp),u=c.data;null!==u&&(a.push([d.getTime(),u]),r.push(u),e.last_value=u,e.last_upload=d)}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}e.chartOptions.series[0].data=a}).catch(function(t){return console.log(t)})},clearAllInterval:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=h()(this.sensors);!(t=(r=n.next()).done);t=!0){var s=r.value;-1!==s.intervalId&&clearInterval(s.intervalId)}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}}},mounted:function(){this.$store.state.User.jwt_token&&(this.$http.setToken(this.$store.state.User.jwt_token),this.projectId=this.$route.params.id,this.getProjectDetail(this.projectId),this.getDeviceList(this.projectId),this.getSensorList(this.projectId))},beforeDestroy:function(){this.clearAllInterval()},filters:{ISO8601toLocalTime:function(t){return new Date(t).toLocaleString()}},name:"ProjectDetail"},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:"",md8:"",lg8:"","offset-md1":"","offset-lg1":""}},[a("h1",[t._v("物聯網專案名稱: "+t._s(t.project.name))]),t._v(" "),a("div",[t._v("物聯網專案 id: "+t._s(t.project.id))]),t._v(" "),a("div",[t._v("專案最後更新時間: "+t._s(t._f("ISO8601toLocalTime")(t.project.updated_at)))]),t._v(" "),a("div",[t._v("專案描述: "+t._s(t.project.description))])]),t._v(" "),a("v-flex",{attrs:{xs2:"",md2:"",lg1:"","offset-md1":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{attrs:{slot:"activator",color:"primary",block:"",dark:""},slot:"activator"},[a("v-card-text",[t._v("新增裝置")])],1),t._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("新增裝置")])]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"裝置名稱",required:""},model:{value:t.newDeviceName,callback:function(e){t.newDeviceName=e},expression:"newDeviceName"}}),t._v(" "),a("v-textarea",{attrs:{label:"裝置描述",required:""},model:{value:t.newProjectDetail,callback:function(e){t.newProjectDetail=e},expression:"newProjectDetail"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("關閉")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){return t.createDevice(e)}}},[t._v("儲存")])],1)],1)],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",md10:"","offset-md1":""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.devices,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",[a("td",[a("a",{on:{click:function(a){if(a.target!==a.currentTarget)return null;t.enterDeviceDetail(e.item.id)}}},[t._v(t._s(e.item.name))])])])]}}])})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},t._l(t.sensors,function(e){return e.data_type in["int","double"]?a("v-flex",{key:e.name,attrs:{xs12:"",md5:"","offset-md1":""}},[a("highcharts",{staticClass:"chart",attrs:{options:e.chartOptions,updateArgs:e.updateArgs}})],1):t._e()}))],1)},staticRenderFns:[]};var y=a("VU/8")(g,w,!1,function(t){a("PYY8")},"data-v-036bec34",null).exports,x={data:function(){return{deviceId:null,device:{},sensors:[],dialog:!1,newSensorName:"",newSensorShowName:"",newSensorType:"",dataTypes:["int","double","bool","string"],headers:[{text:"Name",sortable:!0,value:"name"},{text:"Value",sortable:!1,value:"last_value"},{text:"Update at",sortable:!0,value:"last_upload"}]}},methods:{getDeviceDetail:function(t){var e=this;this.$http.getDeviceDetail(t).then(function(t){var a=t.data;e.device=a}).catch(function(t){console.log(t),e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},getSensorList:function(t){var e=this;this.$http.getSensorsByDevice(t).then(function(t){var a=t.data;e.sensors=a;var r=function(t,a){e.$set(e.sensors[t],"updateArgs",[!0,!0,{duration:1e3}]),e.$set(e.sensors[t],"chartOptions",{chart:{type:"spline",zoomType:"x"},rangeSelector:{buttons:[{type:"day",count:3,text:"3d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],selected:3},title:{text:a.showname},xAxis:{type:"datetime",title:{text:"Time (UTC)"}},plotOptions:{spline:{marker:{enabled:!0}}},series:[{data:[],color:"#6fcd98",name:a.showname,tooltip:{valueDecimals:2}}]});var r=setInterval(function(){return e.getSensorData(a.id)},5e3);e.$set(e.sensors[t],"intervalId",r),e.$set(e.sensors[t],"last_value",null),e.$set(e.sensors[t],"last_upload",null)},n=!0,s=!1,o=void 0;try{for(var i,l=h()(e.sensors.entries());!(n=(i=l.next()).done);n=!0){var c=i.value,d=_()(c,2);r(d[0],d[1])}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}})},createSensor:function(){var t=this;this.$http.createSensor(this.newSensorName,this.newSensorShowName,this.newSensorType,this.deviceId).then(function(e){e.data;t.clearAllInterval(),t.getSensorList(t.deviceId),t.dialog=!1})},getSensorData:function(t){var e=null,a=!0,r=!1,n=void 0;try{for(var s,o=h()(this.sensors);!(a=(s=o.next()).done);a=!0){var i=s.value;if(i.id===t){e=i;break}}}catch(t){r=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}this.$http.getDataBySensorId(t).then(function(t){var a=[],r=[],n=!0,s=!1,o=void 0;try{for(var i,l=h()(t.data);!(n=(i=l.next()).done);n=!0){var c=i.value,d=new Date(1e3*c.timestamp),u=c.data;null!==u&&(a.push([d.getTime(),u]),r.push(u),e.last_value=u,e.last_upload=d)}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}e.chartOptions.series[0].data=a}).catch(function(t){return console.log(t)})},clearAllInterval:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=h()(this.sensors);!(t=(r=n.next()).done);t=!0){var s=r.value;-1!==s.intervalId&&clearInterval(s.intervalId)}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}},enterSensorDetail:function(t){this.$router.push({name:"sensorDetail",params:{id:t}})}},mounted:function(){this.$store.state.User.jwt_token&&(this.$http.setToken(this.$store.state.User.jwt_token),this.deviceId=this.$route.params.id,this.getDeviceDetail(this.deviceId),this.getSensorList(this.deviceId))},beforeDestroy:function(){this.clearAllInterval()},filters:{ISO8601toLocalTime:function(t){if(t)return new Date(t).toLocaleString()}},name:"Device Detail"},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:"",md8:"",lg8:"","offset-md1":"","offset-lg1":""}},[a("h1",[t._v("物聯網裝置名稱: "+t._s(t.device.name))]),t._v(" "),a("div",[t._v("物聯網裝置 id: "+t._s(t.device.id))]),t._v(" "),a("div",[t._v("所屬的專案 id: "+t._s(t.device.project))]),t._v(" "),a("div",[t._v("裝置資料最後更新時間: "+t._s(t._f("ISO8601toLocalTime")(t.device.updated_at)))]),t._v(" "),a("div",[t._v("裝置詳細內容: "+t._s(t.device.description))]),t._v(" "),a("div",[t._v("裝置上傳 Token: "+t._s(t.device.access_token))])]),t._v(" "),a("v-flex",{attrs:{xs2:"",md2:"",lg2:"","offset-md1":""}},[a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{attrs:{slot:"activator",color:"primary",block:"",dark:""},slot:"activator"},[a("v-card-text",[t._v("新增感測器")])],1),t._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("新增感測器")])]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"感測器名稱",required:""},model:{value:t.newSensorName,callback:function(e){t.newSensorName=e},expression:"newSensorName"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"感測器顯示名稱",required:""},model:{value:t.newSensorShowName,callback:function(e){t.newSensorShowName=e},expression:"newSensorShowName"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-select",{attrs:{items:t.dataTypes,label:"感測器顯示型別"},model:{value:t.newSensorType,callback:function(e){t.newSensorType=e},expression:"newSensorType"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("關閉")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){return t.createSensor(e)}}},[t._v("儲存")])],1)],1)],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",md10:"","offset-md1":""}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.sensors,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",[a("td",[t._v(t._s(e.item.showname)+" ("+t._s(e.item.name)+")")]),t._v(" "),a("td",[t._v(t._s(e.item.last_value))]),t._v(" "),a("td",[t._v(t._s(t._f("ISO8601toLocalTime")(e.item.last_upload)))])])]}}])})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},t._l(t.sensors,function(t){return a("v-flex",{key:t.name,attrs:{xs12:"",md5:"","offset-md1":""}},[a("highcharts",{staticClass:"stock",attrs:{options:t.chartOptions,updateArgs:t.updateArgs}})],1)}))],1)},staticRenderFns:[]};var j=a("VU/8")(x,S,!1,function(t){a("qz22")},"data-v-81f9df70",null).exports,k={data:function(){return{deviceId:null,device:{},sensors:[],dialog:!1,newSensorName:"",newSensorShowName:"",headers:[{text:"Name",sortable:!0,value:"name"},{text:"Value",sortable:!1,value:"last_value"},{text:"Update at",sortable:!0,value:"last_upload"}]}},methods:{getDeviceDetail:function(t){var e=this;this.$http.getDeviceDetail(t).then(function(t){var a=t.data;e.device=a}).catch(function(t){console.log(t),e.$store.dispatch("SET_ALERT",{type:"error",message:t.response.data.message||t.response.data.detail})})},getSensorList:function(t){var e=this;this.$http.getSensorsByDevice(t).then(function(t){var a=t.data;e.sensors=a;var r=function(t,a){e.$set(e.sensors[t],"updateArgs",[!0,!0,{duration:1e3}]),e.$set(e.sensors[t],"chartOptions",{chart:{type:"spline",zoomType:"x"},rangeSelector:{buttons:[{type:"day",count:3,text:"3d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],selected:3},title:{text:a.showname},xAxis:{type:"datetime",title:{text:"Time (UTC)"}},plotOptions:{spline:{marker:{enabled:!0}}},series:[{data:[],color:"#6fcd98",name:a.showname,tooltip:{valueDecimals:2}}]});var r=setInterval(function(){return e.getSensorData(a.id)},5e3);e.$set(e.sensors[t],"intervalId",r),e.$set(e.sensors[t],"last_value",null),e.$set(e.sensors[t],"last_upload",null)},n=!0,s=!1,o=void 0;try{for(var i,l=h()(e.sensors.entries());!(n=(i=l.next()).done);n=!0){var c=i.value,d=_()(c,2);r(d[0],d[1])}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}})},createSensor:function(){var t=this;this.$http.createSensor(this.newSensorName,this.newSensorShowName,this.deviceId).then(function(e){e.data;t.clearAllInterval(),t.getSensorList(t.deviceId),t.dialog=!1})},getSensorData:function(t){var e=null,a=!0,r=!1,n=void 0;try{for(var s,o=h()(this.sensors);!(a=(s=o.next()).done);a=!0){var i=s.value;if(i.id===t){e=i;break}}}catch(t){r=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}this.$http.getDataBySensorId(t).then(function(t){var a=[],r=[],n=!0,s=!1,o=void 0;try{for(var i,l=h()(t);!(n=(i=l.next()).done);n=!0){var c=i.value,d=new Date(1e3*c.timestamp),u=c.data;null!==u&&(a.push([d.getTime(),u]),r.push(u),e.last_value=u,e.last_upload=d)}}catch(t){s=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}e.chartOptions.series[0].data=a}).catch(function(t){return console.log(t)})},clearAllInterval:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=h()(this.sensors);!(t=(r=n.next()).done);t=!0){var s=r.value;-1!==s.intervalId&&clearInterval(s.intervalId)}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}}},mounted:function(){this.$store.state.User.jwt_token&&(this.$http.setToken(this.$store.state.User.jwt_token),this.deviceId=this.$route.params.id,this.getDeviceDetail(this.deviceId),this.getSensorList(this.deviceId))},beforeDestroy:function(){this.clearAllInterval()},filters:{ISO8601toLocalTime:function(t){if(t)return new Date(t).toLocaleString()}},name:"Device Detail"},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:"","grid-list-md":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:"",md8:"",lg8:"","offset-md1":"","offset-lg1":""}},[a("h1",[t._v("感測器名稱: "+t._s(t.sensor.name))]),t._v(" "),a("div",[t._v("感測器顯示名稱: "+t._s(t.sensor.showname))]),t._v(" "),a("div",[t._v("最後更新時間: "+t._s(t._f("ISO8601toLocalTime")(t.device.updated_at)))])])],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-card",[a("v-list",{attrs:{dense:""}},[a("v-list-tile",[a("v-list-tile-content",[t._v("Calories:")]),t._v(" "),a("v-list-tile-content",{staticClass:"align-end"},[t._v(t._s(t.props.item.calories))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(k,D,!1,function(t){a("TxR6")},"data-v-10ab8d0c",null).exports;r.default.use(l.a);var $=new l.a({routes:[{path:"/",redirect:"/project"},{path:"/login",name:"login",component:d},{path:"/project",name:"project",component:f},{path:"/project/:id",name:"projectDetail",component:y},{path:"/device/:id",name:"deviceDetail",component:j},{path:"/sensor/:id",name:"sensorDetail",component:b}]}),T=a("NYxO"),I=a("2mV7");r.default.use(T.a);var E=new T.a.Store({modules:I.default,strict:!1}),L=a("mtWM"),P=a.n(L),A={install:function(t,e){t.prototype.$http={setToken:function(t){P.a.defaults.headers.common.Authorization="JWT "+t},login:function(t,e){return P.a.post("/api/login",{username:t,password:e})},getme:function(){return P.a.get("/api/get-me")},getProjects:function(){return P.a.get("/api/projects")},createProject:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return P.a.post("/api/projects",{name:t,description:e})},getProjectDetail:function(t){return P.a.get("/api/project/"+t)},getDevices:function(t){return P.a.get("/api/devices",{params:{project:t}})},createDevice:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return P.a.post("/api/devices",{name:t,project:e,description:a})},getDeviceDetail:function(t){return P.a.get("/api/device/"+t)},getSensorsByProject:function(t){return P.a.get("/api/sensors",{params:{project:t}})},getSensorsByDevice:function(t){return P.a.get("/api/sensors",{params:{device:t}})},createSensor:function(t,e,a,r){return P.a.post("/api/sensors",{name:t,showname:e,data_type:a,device:r})},getSensorDetail:function(t){return P.a.get("/api/sensor/"+t)},getDataBySensorId:function(t){return P.a.get("/api/data",{params:{sensor:t}})}}}},N=A,O=a("3EgV"),R=a.n(O),U=a("jhCd"),V=a.n(U),C=a("504h"),z=a.n(C),B=a("WOHC"),M=a.n(B),q=a("jgbR"),F=a.n(q);a("7zck");r.default.use(R.a),r.default.use(V.a),r.default.use(N),M()(z.a),F()(z.a),r.default.config.productionTip=!1,new r.default({el:"#app",router:$,store:E,components:{App:i},template:"<App/>"})},PYY8:function(t,e){},TxR6:function(t,e){},VLN1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={id:null,username:"",firstName:"",lastName:"",email:"",isStaff:!1,alreadyLogin:!1,jwt_token:window.localStorage.getItem("jwt_token")},n={SET_USER:function(t,e){t.id=e.id,t.username=e.username,t.firstName=e.first_name,t.lastName=e.last_name,t.email=e.email,t.isStaff=e.is_staff,t.alreadyLogin=!0},SET_JWT_TOKEN:function(t,e){window.localStorage.setItem("jwt_token",e),t.token=e},REMOVE_JWT_TOKEN:function(t){t.token=null,window.localStorage.removeItem("jwt_token")},REMOVE_USER:function(t){t.alreadyLogin=!1}};e.default={state:r,mutations:n}},gNcp:function(t,e,a){var r={"./Alert.js":"yw02","./User.js":"VLN1","./index.js":"2mV7"};function n(t){return a(s(t))}function s(t){var e=r[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}n.keys=function(){return Object.keys(r)},n.resolve=s,t.exports=n,n.id="gNcp"},pNoV:function(t,e){},qz22:function(t,e){},xVVC:function(t,e){},yw02:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={show:!1,message:"",type:void 0},n={SET_ALERT:function(t,e){var a=e.countdown||10;t.commit("SET_ALERT",e),setTimeout(function(){t.commit("REMOVE_ALERT")},1e3*a)}};e.default={state:r,mutations:{SET_ALERT:function(t,e){t.show=!0,t.type=e.type,t.message=e.message},REMOVE_ALERT:function(t){t.show=!1}},actions:n}}},["NHnr"]);
//# sourceMappingURL=app.80b428938c040b1566ed.js.map